machine:
  services:
    - docker

dependencies:
  override:
    - docker info
    - docker build -t texastribune/checkout .
    - docker build -f Dockerfile.dev -t texastribune/checkout:dev .

test:
  override:
    - docker run -it --rm --workdir=/app --entrypoint=python3 texastribune/checkout:dev /usr/local/bin/py.test tests.py --cov=.
  post:
    - cp htmlcov/* $CIRCLE_ARTIFACTS
